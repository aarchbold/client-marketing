$.fn.handleNewsletter=function(){function e(){i.prop("disabled",!0),t.prop("disabled",!0),p.show()}function o(){i.prop("disabled",!1),t.prop("disabled",!1),p.hide()}function n(e){console.log("signs up for email service");var n="http://www.someurl.com/api/capture_email",s={email:e};$.post(n,JSON.stringify(s),function(){r.show(),l.hide(),a.hide(),o()}).fail(function(e){r.hide(),l.show(),i.addClass("-error"),o()})}var s=$(this),i=$(".newsletter-signup__input",s),t=$(".button__signup",s),r=$(".newsletter-signup__form.-success",s),l=$(".newsletter-signup__form.-fail",s),a=$(".newsletter-signup__form.-entry",s),p=$(".newsletter-signup__spinner",s),u=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i;console.log(i),console.log(t),console.log(r),console.log(l),t.click(function(o){o.preventDefault(),i.removeClass("-error"),l.hide(),r.hide(),u.test(i.val())?(e(),n(i.val())):(l.show(),i.addClass("-error"))})},$(function(){$(".newsletter-signup").handleNewsletter()});